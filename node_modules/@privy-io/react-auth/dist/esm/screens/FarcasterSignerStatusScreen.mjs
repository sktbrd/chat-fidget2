import{jsxs as o,Fragment as e,jsx as t}from"react/jsx-runtime";import{useState as r,useRef as n,useEffect as i}from"react";import{isMobile as s,isIOS as c}from"react-device-detect";import{styled as a}from"styled-components";import{PrimaryButton as m}from"../components/Button.mjs";import{CopytoClipboardButton as l}from"../components/CopyToClipboard.mjs";import{RefactorSpacerTop as p,FixedGappedContainer as d,CenteredItem as h,CenteredItemWithPadding as u}from"../components/Layouts.mjs";import{ConnectionLoader as j,Loader as f}from"../components/Loader.mjs";import{ModalFooter as g}from"../components/ModalFooter.mjs";import{ModalHeader as v}from"../components/ModalHeader.mjs";import{OpenLinkButton as y}from"../components/OpenLink.mjs";import{QrCode as k}from"../components/QrCode.mjs";import w from"../components/layout/StackedContainer.mjs";import{DEFAULT_SUCCESS_SCREEN_DURATION_MS as x}from"../constants.mjs";import{usePrivyInternal as b}from"../hooks/internal-context.mjs";import{usePrivyModal as C}from"../hooks/modal-context.mjs";import{Farcaster as S}from"../svg/farcaster.mjs";import{Title as I,SubTitle as T}from"./MfaScreens/StyledComponents.mjs";import"../svg/checkmark.mjs";import"../svg/copy.mjs";import"../svg/protected-by-privy.mjs";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"../configuration/context.mjs";import"../config.mjs";import"../configuration/defaultClientConfig.mjs";import"../configuration/login-methods.mjs";import"../configuration/wallets.mjs";import"../connectors/chains/index.mjs";import"../connectors/chains/arbitrum.mjs";import"../connectors/chains/arbitrumSepolia.mjs";import"../connectors/chains/avalanche.mjs";import"../connectors/chains/avalancheFuji.mjs";import"../connectors/chains/base.mjs";import"../connectors/chains/baseSepolia.mjs";import"../connectors/chains/berachainArtio.mjs";import"../connectors/chains/celo.mjs";import"../connectors/chains/celoAlfajores.mjs";import"../connectors/chains/filecoin.mjs";import"../connectors/chains/filecoinCalibration.mjs";import"../connectors/chains/garnetHolesky.mjs";import"../connectors/chains/holesky.mjs";import"../connectors/chains/linea.mjs";import"../connectors/chains/lineaTestnet.mjs";import"../connectors/chains/lukso.mjs";import"../connectors/chains/mainnet.mjs";import"../connectors/chains/optimism.mjs";import"../connectors/chains/optimismSepolia.mjs";import"../connectors/chains/polygon.mjs";import"../connectors/chains/polygonAmoy.mjs";import"../connectors/chains/redstone.mjs";import"../connectors/chains/sepolia.mjs";import"../connectors/chains/zora.mjs";import"../connectors/chains/zoraSepolia.mjs";import"../connectors/chains/zoraTestnet.mjs";import"../connectors/chains/utils.mjs";import"../lib/solana/index.mjs";import"../theme.mjs";import"tinycolor2";import"../lib/cybr53.mjs";import"../hooks/index.mjs";import"qrcode";import"../svg/black-rounded-square.mjs";import"../utils/index.mjs";import"@ethersproject/providers";import"../connectors/get-legacy-injected-providers.mjs";import"../connectors/is-wallet-installed.mjs";import"../errors.mjs";import"ofetch";import"../components/PrefetchedImage.mjs";import"./index.mjs";let _="#8a63d2";const A=()=>{let{lastScreen:a,navigateBack:A,data:M,app:L}=C(),{requestFarcasterSignerStatus:O,closePrivyModal:z}=b(),[P,B]=r(void 0),[D,N]=r(!1),[R,W]=r(!1),E=n([]),H=M?.farcasterSigner;i((()=>{let o=Date.now(),e=setInterval((async()=>{if(!H?.public_key)return clearInterval(e),void B({retryable:!0,message:"Connect failed",detail:"Something went wrong. Please try again."});"approved"===H.status&&(clearInterval(e),N(!1),W(!0),E.current.push(setTimeout((()=>z({shouldCallAuthOnSuccess:!1,isSuccess:!0})),x)));let t=await O(H?.public_key),r=Date.now()-o;"approved"===t.status?(clearInterval(e),N(!1),W(!0),E.current.push(setTimeout((()=>z({shouldCallAuthOnSuccess:!1,isSuccess:!0})),x))):r>3e5?(clearInterval(e),B({retryable:!0,message:"Connect failed",detail:"The request timed out. Try again."})):"revoked"===t.status&&(clearInterval(e),B({retryable:!0,message:"Request rejected",detail:"The request was rejected. Please try again."}))}),2e3);return()=>{clearInterval(e),E.current.forEach((o=>clearTimeout(o)))}}),[]);let Q="pending_approval"===H?.status?H.signer_approval_url:void 0;/*#__PURE__*/return o(e,s||D?{children:[/*#__PURE__*/t(v,{backFn:a?A:void 0,onClose:z},"header"),/*#__PURE__*/t(p,{}),
/*#__PURE__*/t(e,c?{children:/*#__PURE__*/o(F,{children:[/*#__PURE__*/t(w,{children:/*#__PURE__*/o("div",{children:[/*#__PURE__*/t(j,{success:R,fail:!!P}),/*#__PURE__*/t(S,{style:{width:"38px",height:"38px"}})]})}),/*#__PURE__*/o(d,{children:[/*#__PURE__*/t(I,{children:P?P.message:"Add a signer to Farcaster"}),/*#__PURE__*/t(T,{children:P?P.detail:"This will allow "+L.name+" to add casts, likes, follows, and more on your behalf."})]}),Q&&/*#__PURE__*/t(m,{onClick:o=>{o.preventDefault(),window.location.href=Q},children:"Open Warpcast app"})]})}:{children:/*#__PURE__*/o(q,{children:[/*#__PURE__*/t(w,{children:/*#__PURE__*/o("div",{children:[/*#__PURE__*/t(j,{success:R,fail:!!P}),/*#__PURE__*/t(S,{style:{width:"38px",height:"38px"}})]})}),/*#__PURE__*/o(d,{children:[/*#__PURE__*/t(I,{children:P?P.message:"Requesting signer from Farcaster"}),/*#__PURE__*/t(T,{children:P?P.detail:"This should only take a moment"}),/*#__PURE__*/t(h,{children:Q&&s&&/*#__PURE__*/t(y,{text:"Take me to Warpcast",url:Q,color:_})})]})]})}),/*#__PURE__*/t(g,{})]}:{children:[/*#__PURE__*/t(v,{backFn:a?A:void 0,onClose:z},"header"),/*#__PURE__*/t(p,{}),/*#__PURE__*/t(q,{children:/*#__PURE__*/o("div",{children:[/*#__PURE__*/t(I,{children:"Add a signer to Farcaster"}),/*#__PURE__*/o(T,{children:["This will allow ",L.name," to add casts, likes, follows, and more on your behalf."]}),/*#__PURE__*/t(u,{children:"pending_approval"===H?.status?/*#__PURE__*/t(k,{url:H.signer_approval_url,size:275,squareLogoElement:S}):/*#__PURE__*/t(f,{})}),/*#__PURE__*/o(h,{children:[/*#__PURE__*/t(T,{children:"Or copy this link and paste it into a phone browser to open the Warpcast app."}),"pending_approval"===H?.status&&/*#__PURE__*/t(l,{text:H.signer_approval_url,itemName:"link",color:_})]})]})}),/*#__PURE__*/t(g,{})]})};let q=/*#__PURE__*/a.div.withConfig({displayName:"ConnectContainer",componentId:"sc-6e2c96cd-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;margin-left:27px;margin-right:27px;gap:24px;"]),F=/*#__PURE__*/a.div.withConfig({displayName:"ConnectContainerButton",componentId:"sc-6e2c96cd-1"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;"]);export{A as FarcasterSignerStatusScreen};
