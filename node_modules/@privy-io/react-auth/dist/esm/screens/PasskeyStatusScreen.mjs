import{jsxs as o,Fragment as r,jsx as t}from"react/jsx-runtime";import{useState as e,useRef as n,useEffect as s}from"react";import{styled as i}from"styled-components";import{PrimaryButton as c}from"../components/Button.mjs";import{FixedGappedContainer as m}from"../components/Layouts.mjs";import{ConnectionLoader as a}from"../components/Loader.mjs";import{ModalFooter as p}from"../components/ModalFooter.mjs";import{ModalHeader as l}from"../components/ModalHeader.mjs";import h from"../components/layout/StackedContainer.mjs";import{DEFAULT_SUCCESS_SCREEN_DURATION_MS as u}from"../constants.mjs";import{PrivyError as d,PrivyErrorCode as j}from"../errors.mjs";import{usePrivyInternal as f}from"../hooks/internal-context.mjs";import{usePrivyModal as y}from"../hooks/modal-context.mjs";import{FingerPrint as g}from"../svg/fingerprint.mjs";import"../svg/protected-by-privy.mjs";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"../configuration/context.mjs";import"../config.mjs";import"../configuration/defaultClientConfig.mjs";import"../configuration/login-methods.mjs";import"../configuration/wallets.mjs";import"../connectors/chains/index.mjs";import"../connectors/chains/arbitrum.mjs";import"../connectors/chains/arbitrumSepolia.mjs";import"../connectors/chains/avalanche.mjs";import"../connectors/chains/avalancheFuji.mjs";import"../connectors/chains/base.mjs";import"../connectors/chains/baseSepolia.mjs";import"../connectors/chains/berachainArtio.mjs";import"../connectors/chains/celo.mjs";import"../connectors/chains/celoAlfajores.mjs";import"../connectors/chains/filecoin.mjs";import"../connectors/chains/filecoinCalibration.mjs";import"../connectors/chains/garnetHolesky.mjs";import"../connectors/chains/holesky.mjs";import"../connectors/chains/linea.mjs";import"../connectors/chains/lineaTestnet.mjs";import"../connectors/chains/lukso.mjs";import"../connectors/chains/mainnet.mjs";import"../connectors/chains/optimism.mjs";import"../connectors/chains/optimismSepolia.mjs";import"../connectors/chains/polygon.mjs";import"../connectors/chains/polygonAmoy.mjs";import"../connectors/chains/redstone.mjs";import"../connectors/chains/sepolia.mjs";import"../connectors/chains/zora.mjs";import"../connectors/chains/zoraSepolia.mjs";import"../connectors/chains/zoraTestnet.mjs";import"../connectors/chains/utils.mjs";import"../lib/solana/index.mjs";import"../theme.mjs";import"tinycolor2";import"../lib/cybr53.mjs";import"../hooks/index.mjs";import"ofetch";import"../components/PrefetchedImage.mjs";import"./index.mjs";const v=()=>{let{lastScreen:i,currentScreen:v,navigateBack:w}=y(),{loginWithPasskey:x,closePrivyModal:b}=f(),[C,S]=e("loading"),[A,I]=e(null),E=n([]);s((()=>()=>{E.current.forEach((o=>clearTimeout(o))),E.current=[]}),[]);let P=async()=>{S("loading");try{await x(),S("success")}catch(o){I(o),S("error")}};return s((()=>{var o;"success"===C&&(o=setTimeout((()=>{b({shouldCallAuthOnSuccess:!0,isSuccess:!0})}),u),E.current=[o,...E.current])}),[C]),s((()=>{P()}),[]),/*#__PURE__*/o(r,{children:[/*#__PURE__*/t(l,{backFn:i&&v!==i?w:void 0}),/*#__PURE__*/o(k,{children:[/*#__PURE__*/t(h,{children:/*#__PURE__*/o("div",{children:[/*#__PURE__*/t(a,{success:"success"===C,fail:"error"===C}),/*#__PURE__*/t(g,{style:{width:"38px",height:"38px"}})]})}),/*#__PURE__*/o(m,{children:[/*#__PURE__*/t("h3",{children:(()=>{switch(C){case"loading":return"Waiting for passkey";case"success":return"Success";case"error":return"Something went wrong"}})()}),/*#__PURE__*/t("p",{style:{whiteSpace:"pre-wrap"},children:(()=>{switch(C){case"loading":return"Please follow prompts to verify your passkey.\nYou will have to sign up with another method first to register a passkey for your account.";case"success":return"You've successfully logged in with your passkey.";case"error":if(A instanceof d){if(A.privyErrorCode===j.CANNOT_LINK_MORE_OF_TYPE)return"Cannot link more passkeys to account.";if(A.privyErrorCode===j.PASSKEY_NOT_ALLOWED)return"Passkey request timed out or rejected by user.\nYou will have to sign up with another method first to register a passkey for your account."}return"An unknown error occurred.\nYou will have to sign up with another method first to register a passkey for your account."}})()})]}),(()=>{switch(C){case"loading":case"success":/*#__PURE__*/return t(c,{onClick:()=>{},disabled:!0,children:"Continue"});case"error":/*#__PURE__*/return t(c,{onClick:P,disabled:!1,children:"Retry"})}})()]}),/*#__PURE__*/t(p,{})]})};let k=/*#__PURE__*/i.div.withConfig({displayName:"Container",componentId:"sc-8944c255-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;"]);const w=/*#__PURE__*/i.div.withConfig({displayName:"DoubleIconWrapper",componentId:"sc-8944c255-1"})(["display:flex;align-items:center;justify-content:center;width:180px;height:90px;border-radius:50%;svg + svg{margin-left:12px;}> svg{z-index:2;color:var(--privy-color-accent) !important;stroke:var(--privy-color-accent) !important;fill:var(--privy-color-accent) !important;}"]);export{w as DoubleIconWrapper,v as PasskeyStatusScreen};
