import{jsx as e}from"react/jsx-runtime";import{Turnstile as r}from"@marsidev/react-turnstile";import{useMemo as t,useEffect as o}from"react";import{useCaptcha as i}from"../hooks/captcha-context.mjs";import"../hooks/index.mjs";import"../errors.mjs";import"ofetch";import"../utils/index.mjs";import"@ethersproject/providers";import"../connectors/get-legacy-injected-providers.mjs";import"../connectors/is-wallet-installed.mjs";const s=s=>{let{enabled:n,siteKey:c,appId:p,setError:a,setToken:d,setExecuting:m,ref:l}=i(),[,u]=t((()=>c?.split("t:")||[]),[c]);if(o((()=>l.current?.remove),[]),!n)return null;if(!u)throw Error("Unsupported captcha site key");/*#__PURE__*/return e("div",{className:"hidden h-0 w-0",children:/*#__PURE__*/e(r,{...s,ref:l,siteKey:u,options:{action:p,size:"invisible",...s.delayedExecution?{appearance:"execute",execution:"execute"}:{appearance:"always",execution:"render"}},onUnsupported:()=>{s.onUnsupported?.(),console.warn("Browser does not support Turnstile.")},onError:()=>{s.onError?.(),a("Captcha failed"),m(!1)},onSuccess:e=>{s.onSuccess?.(e),d(e),m(!1)},onExpire:()=>{s.onExpire?.();try{l.current?.reset(),a(void 0),d(void 0)}catch(e){a("expired_and_failed_reset")}}})})};export{s as Captcha};
