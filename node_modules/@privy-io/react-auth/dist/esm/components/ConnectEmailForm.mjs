import{jsxs as o,Fragment as i,jsx as t}from"react/jsx-runtime";import r from"@heroicons/react/24/outline/EnvelopeIcon";import{forwardRef as n,useState as e,useEffect as s}from"react";import{useAppConfig as m}from"../configuration/context.mjs";import{PrivyError as c,PrivyErrorCode as a}from"../errors.mjs";import{useCaptcha as l}from"../hooks/captcha-context.mjs";import{usePrivyInternal as p}from"../hooks/internal-context.mjs";import{usePrivyModal as h}from"../hooks/modal-context.mjs";import{usePrivyContext as j}from"../hooks/privy-context.mjs";import{useRecentlyUsedLogin as d}from"../recent-login/context.mjs";import{ModalScreen as u}from"../screens/index.mjs";import{validateEmail as f}from"../utils/index.mjs";import{EmbeddedButton as g,PrimaryButton as S}from"./Button.mjs";import{Chip as E}from"./ui/chips/Chip.mjs";import{InputContainerForm as y,EmailInputForm as k}from"./ui/forms/EmailInputForm.mjs";import{ErrorMessage as b}from"./ui/typography/ErrorMessage.mjs";import"../config.mjs";import"../configuration/defaultClientConfig.mjs";import"../constants.mjs";import"../configuration/login-methods.mjs";import"../configuration/wallets.mjs";import"../connectors/chains/index.mjs";import"../connectors/chains/arbitrum.mjs";import"../connectors/chains/arbitrumSepolia.mjs";import"../connectors/chains/avalanche.mjs";import"../connectors/chains/avalancheFuji.mjs";import"../connectors/chains/base.mjs";import"../connectors/chains/baseSepolia.mjs";import"../connectors/chains/berachainArtio.mjs";import"../connectors/chains/celo.mjs";import"../connectors/chains/celoAlfajores.mjs";import"../connectors/chains/filecoin.mjs";import"../connectors/chains/filecoinCalibration.mjs";import"../connectors/chains/garnetHolesky.mjs";import"../connectors/chains/holesky.mjs";import"../connectors/chains/linea.mjs";import"../connectors/chains/lineaTestnet.mjs";import"../connectors/chains/lukso.mjs";import"../connectors/chains/mainnet.mjs";import"../connectors/chains/optimism.mjs";import"../connectors/chains/optimismSepolia.mjs";import"../connectors/chains/polygon.mjs";import"../connectors/chains/polygonAmoy.mjs";import"../connectors/chains/redstone.mjs";import"../connectors/chains/sepolia.mjs";import"../connectors/chains/zora.mjs";import"../connectors/chains/zoraSepolia.mjs";import"../connectors/chains/zoraTestnet.mjs";import"../connectors/chains/utils.mjs";import"../lib/solana/index.mjs";import"../theme.mjs";import"tinycolor2";import"../lib/cybr53.mjs";import"ofetch";import"../hooks/index.mjs";import"@ethersproject/providers";import"../connectors/get-legacy-injected-providers.mjs";import"../connectors/is-wallet-installed.mjs";import"./PrefetchedImage.mjs";import"../hooks/events-context.mjs";import"../storage.mjs";import"styled-components";import"./Loader.mjs";import"./ui/animation/LoadingSkeleton.mjs";const v=/*#__PURE__*/n(((n,y)=>{let[k,v]=e(n.defaultValue||""),[A,R]=e(""),[T,I]=e(!1),{authenticated:D}=j(),{initLoginWithEmail:L}=p(),{navigate:N,setModalData:P,currentScreen:_,data:O}=h(),{enabled:W,token:w}=l(),[M,U]=e(!1),{accountType:z}=d(),F=m();s((()=>{!k&&F.disablePlusEmails&&O?.inlineError?.error instanceof c&&O?.inlineError?.error.privyErrorCode===a.DISALLOWED_PLUS_EMAIL&&!A&&R("Please enter a valid email address without a '+'."),A&&R("")}),[k]);let G=f(k),H=T||!G,q=()=>{var o;P({inlineError:void 0}),!W||w||D?(o=w,I(!0),L({email:k,captchaToken:o,disableSignup:O?.login?.disableSignup,withPrivyUi:!0}).then((()=>{N(u.AWAITING_PASSWORDLESS_CODE)})).catch((o=>{P({errorModalData:{error:o,previousScreen:_||u.LANDING}}),N(u.ERROR_SCREEN)})).finally((()=>{I(!1)}))):(P({captchaModalData:{callback:o=>L({email:k,captchaToken:o,withPrivyUi:!0}),userIntentRequired:!1,onSuccessNavigateTo:u.AWAITING_PASSWORDLESS_CODE,onErrorNavigateTo:u.ERROR_SCREEN}}),N(u.CAPTCHA_SCREEN))};/*#__PURE__*/return o(i,{children:[/*#__PURE__*/o(x,{children:[A&&/*#__PURE__*/t(b,{style:{display:"block",marginTop:"0.25rem",textAlign:"left"},children:A}),/*#__PURE__*/o(C,{stacked:n.stacked,$error:!!A,children:[/*#__PURE__*/t(r,{}),/*#__PURE__*/t("input",{ref:y,id:"email-input",className:"login-method-button",type:"email",placeholder:"your@email.com",onFocus:()=>U(!0),onChange:o=>v(o.target.value),onKeyUp:o=>{"Enter"===o.key&&q()},value:k,autoComplete:"email"}),"email"!==z||M?n.stacked?/*#__PURE__*/t("span",{}):/*#__PURE__*/t(g,{isSubmitting:T,onClick:q,disabled:H,children:"Submit"}):/*#__PURE__*/t(E,{color:"gray",children:"Recent"})]})]}),n.stacked?/*#__PURE__*/t(S,{loadingText:null,loading:T,disabled:H,onClick:q,children:"Submit"}):null]})}));let x=y,C=k;export{v as ConnectEmailForm};
