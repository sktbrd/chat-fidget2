import{StaticJsonRpcProvider as e}from"@ethersproject/providers";import{getLegacyInjectedProviders as t,getLegacyInjectedName as r}from"../connectors/get-legacy-injected-providers.mjs";import{isMetaMask as n}from"../connectors/is-wallet-installed.mjs";import{PrivyConnectorError as i}from"../errors.mjs";import"ofetch";const o=(e,t)=>{let r=[],n=[];for(let[i,o]of e.entries())i<t?r.push(o):n.push(o);return[r,n]},l=e=>!!String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),s=(e,t)=>{let r=e.slice(0),n=[];for(;r.length;)n.push(r.splice(0,t));return n},p=(e,t=3,r=4,n="ethereum")=>{if(!e)return"";let i="ethereum"===n?2:0;return t+r+i+3>=e.length?e:`${e.slice(0,i+t)}...${e.slice(e.length-r,e.length)}`},a=(e,t=3,r=4)=>p(e,t,r,"solana"),c=e=>new Promise((t=>setTimeout(t,e)));function u(e,{interval:t=100,timeout:r=5e3}={}){return new Promise(((n,i)=>{let o,l=0,s=()=>{l>=r?i("Max attempts reached without result"):(o=e(),l+=t,null==o?setTimeout(s,t):n(o))};s()}))}const d=(e,t={})=>{let r=t.delayMs||150,n=t.maxAttempts||270;return new Promise((async(i,o)=>{let l=!1,s=0;for(;!l&&s<n;){if(t.abortSignal?.aborted)return;e().then((e=>{l=!0,i(e)}),((...e)=>{l=!0,o(...e)})),s+=1,await c(r)}l||o(Error("Exceeded max attempts before resolving function"))}))},f=(e,t,r={},n={})=>{let i=new URL(t,e);for(let[e,t]of Object.entries(r))void 0!==t&&i.searchParams.set(e,t);let o=Object.entries(n);if(o.length>0){let e=new URLSearchParams;for(let[t,r]of o)e.append(t,r);i.hash=e.toString()}return i.href},m=(e,t)=>e.toLowerCase()===t.toLowerCase(),h=(e,t)=>{for(let r of e)if(m(r,t))return!0;return!1},y=e=>e.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g,""),w=e=>"string"==typeof e?e:"0x"+e.toString(16);async function v({store:e,walletList:i,externalWalletConfig:o,walletChainType:l,timeout:s=3e3}){let p=!1,a=window;return new Promise((c=>{function u(){if(p)return;p=!0,window.removeEventListener("ethereum#initialized",u);let s=e.getProviders();console.debug("Detected injected providers:",s.map((e=>e.info)));let a=[];for(let e of s)i.includes("coinbase_wallet")&&"com.coinbase.wallet"===e.info.rdns||"solana-only"===l&&"app.phantom"===e.info.rdns||a.push({type:e.info.name.toLowerCase().replace(/\s/g,"_"),eip6963InjectedProvider:e});if("solana-only"!==l)for(let e of t()){let t=r(e);if(!s.some((e=>e.info.name===t))){if(n(e,!0)&&!a.find((e=>"metamask"===e.type))){a.push({type:"metamask",legacyInjectedProvider:e});continue}if("Phantom"===t&&!a.find((e=>"phantom"===e.type))){a.push({type:"phantom",legacyInjectedProvider:e});continue}if("Coinbase Wallet"===t&&!a.find((e=>"coinbase_wallet"===e.type&&"smartWalletOnly"!==o.coinbaseWallet?.connectionOptions))){a.push({type:"coinbase_wallet",legacyInjectedProvider:e});continue}a.find((e=>"unknown_browser_extension"===e.type))||a.push({type:"unknown_browser_extension",legacyInjectedProvider:e})}}c(a)}a.ethereum?u():(window.addEventListener("ethereum#initialized",u,{once:!0}),setTimeout((()=>{u()}),s))}))}function g(e){return`eip155:${String(Number(e))}`}const U=e=>y(e).toLowerCase().replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s/g,"_"),b=(e,t,r,n)=>{let o=Number(e),l=t.find((e=>e.id===o));if(!l)throw new i(`Unsupported chainId ${e}`,4901);return P(l,r,n)},P=(e,t,r)=>{let n,o=e.id,l=Number(e.id);if(e.rpcUrls.privyWalletOverride&&e.rpcUrls.privyWalletOverride.http[0])n=e.rpcUrls.privyWalletOverride.http[0];else if(t.rpcUrls&&t.rpcUrls[l])n=t.rpcUrls[l];else if(e.rpcUrls.privy?.http[0]){let t=new URL(e.rpcUrls.privy.http[0]);t.searchParams.append("privyAppId",r),n=t.toString()}else n=e.rpcUrls.public?.http[0]?e.rpcUrls.public.http[0]:e.rpcUrls.default?.http[0];if(!n)throw new i(`No RPC url found for ${o}`);return n},D=(e,t)=>{let r=Number(e),n=t.find((e=>e.id===r));if(!n)throw new i(`Unsupported chainId ${e}`,4901);return n.blockExplorers?.default.url},j=(t,r,n,o)=>{let l=Number(t),s=r.find((e=>e.id===l));if(!s)throw new i(`Unsupported chainId ${t}`,4901);return new e(s.rpcUrls.privyWalletOverride&&s.rpcUrls.privyWalletOverride.http[0]?s.rpcUrls.privyWalletOverride.http[0]:n.rpcUrls&&n.rpcUrls[l]?n.rpcUrls[l]:s.rpcUrls.privy?.http[0]?{url:s.rpcUrls.privy.http[0],headers:{"privy-app-id":o.appId}}:s.rpcUrls.public?.http[0]?s.rpcUrls.public.http[0]:s.rpcUrls.default?.http[0])},F=e=>{let t={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},r=e.types.EIP712Domain??Object.entries(e.domain).map((([e,r])=>{if(null!=r&&"string"==typeof e&&e in t)return{name:e,type:t[e]}})).filter((e=>void 0!==e));return{...e,types:{...e.types,EIP712Domain:r}}};function C(e,{min:t,max:r}){return Math.min(Math.max(e,t),r)}export{C as clamp,f as constructURL,h as containsEthAddress,s as convert1dTo2dArray,v as detectInjectedConnectors,g as formatChainIdToCAIP2,a as formatSolanaWalletAddress,p as formatWalletAddress,F as generateTypedDataWithDomainType,D as getBlockExplorer,b as getJsonRpcEndpoint,P as getJsonRpcEndpointFromChain,j as getJsonRpcProvider,d as invokeUntilSettled,U as normalizeWalletShortName,u as pollForResult,m as sameEthAddress,c as sleep,o as splitAtIndex,y as stripEmoji,w as toHex,l as validateEmail};
