import{jsxs as o,jsx as e}from"react/jsx-runtime";import{render as t,fireEvent as n}from"@testing-library/react";import"@testing-library/jest-dom";import{PrivyContext as s,usePrivyContext as i}from"../../hooks/privy-context.mjs";import{UserPill as r}from"./UserPill.mjs";import"react";import"../../hooks/index.mjs";import"../../components/Loader.mjs";import"styled-components";import"../../hooks/useConnectWallet.mjs";import"../../hooks/events-context.mjs";import"../../hooks/useLogin.mjs";import"../../hooks/useWallets.mjs";import"../shared/PillButton.mjs";import"./Avatar.mjs";import"./PrimaryAccount.mjs";import"../../recent-login/context.mjs";import"../../configuration/context.mjs";import"../../config.mjs";import"../../configuration/defaultClientConfig.mjs";import"../../constants.mjs";import"../../configuration/login-methods.mjs";import"../../configuration/wallets.mjs";import"../../connectors/chains/index.mjs";import"../../connectors/chains/arbitrum.mjs";import"../../connectors/chains/arbitrumSepolia.mjs";import"../../connectors/chains/avalanche.mjs";import"../../connectors/chains/avalancheFuji.mjs";import"../../connectors/chains/base.mjs";import"../../connectors/chains/baseSepolia.mjs";import"../../connectors/chains/berachainArtio.mjs";import"../../connectors/chains/celo.mjs";import"../../connectors/chains/celoAlfajores.mjs";import"../../connectors/chains/filecoin.mjs";import"../../connectors/chains/filecoinCalibration.mjs";import"../../connectors/chains/garnetHolesky.mjs";import"../../connectors/chains/holesky.mjs";import"../../connectors/chains/linea.mjs";import"../../connectors/chains/lineaTestnet.mjs";import"../../connectors/chains/lukso.mjs";import"../../connectors/chains/mainnet.mjs";import"../../connectors/chains/optimism.mjs";import"../../connectors/chains/optimismSepolia.mjs";import"../../connectors/chains/polygon.mjs";import"../../connectors/chains/polygonAmoy.mjs";import"../../connectors/chains/redstone.mjs";import"../../connectors/chains/sepolia.mjs";import"../../connectors/chains/zora.mjs";import"../../connectors/chains/zoraSepolia.mjs";import"../../connectors/chains/zoraTestnet.mjs";import"../../connectors/chains/utils.mjs";import"../../lib/solana/index.mjs";import"../../theme.mjs";import"tinycolor2";import"../../lib/cybr53.mjs";import"../../storage.mjs";import"./Account.mjs";import"../../components/CopyableText.mjs";import"@heroicons/react/24/outline/CheckIcon";import"../../svg/copy.mjs";import"../../components/LoginMethodIcon.mjs";import"../../icons/KeyRound.mjs";import"../../icons/Login.mjs";import"../../icons/Mail.mjs";import"../../icons/Phone.mjs";import"../../icons/Socials.mjs";import"../../icons/TicketCheck.mjs";import"../../icons/WalletCards.mjs";import"../../icons/Wallets.mjs";import"../../utils/index.mjs";import"@ethersproject/providers";import"../../connectors/get-legacy-injected-providers.mjs";import"../../connectors/is-wallet-installed.mjs";import"../../errors.mjs";import"ofetch";import"./UserMenu.mjs";import"../../components/ModalFooter.mjs";import"../../svg/protected-by-privy.mjs";import"./BackButton.mjs";import"../../icons/ArrowLeft.mjs";import"./MenuProvider.mjs";import"./Menu.mjs";import"../shared/X.mjs";import"./Popover.mjs";import"@floating-ui/react";import"./screens/MenuScreen.mjs";import"../../hooks/useElementHeight.mjs";import"./screens/AccountScreen.mjs";import"@heroicons/react/24/outline/UserIcon";import"../../hooks/useLogout.mjs";import"../../icons/Logout.mjs";import"./AddFundsButton.mjs";import"../../hooks/useFundWallet.mjs";import"../../hooks/internal-context.mjs";import"./PrimaryWallet.mjs";import"../../components/ui/wallet/WalletInfoCard.mjs";import"../../components/ui/chips/Chip.mjs";import"../../components/ui/animation/LoadingSkeleton.mjs";import"../../components/ui/layout/Column.mjs";import"../../components/ui/typography/ErrorMessage.mjs";import"../../components/ui/typography/LabelXs.mjs";import"../../components/ui/wallet/Address.mjs";import"@heroicons/react/24/outline/Square2StackIcon";import"../../components/ui/wallet/shared.mjs";import"../../hooks/useWalletBalance.mjs";import"viem";import"../../lib/ethers.mjs";import"@ethersproject/bignumber";import"@ethersproject/units";import"@privy-io/js-sdk-core";import"./PrimaryWalletContainer.mjs";import"./screens/LinkedAccountsScreen.mjs";import"@heroicons/react/24/outline/EllipsisHorizontalIcon";import"./screens/WalletActionsScreen.mjs";import"@heroicons/react/24/outline/PlusCircleIcon";import"../../hooks/useFundSolanaWallet.mjs";import"../../plugins/context/PrivyPluginContext.mjs";import"../../plugins/solana-funding/plugin.mjs";import"@solana/web3.js";import"../../plugins/solana-funding/id.mjs";import"../../screens/index.mjs";import"../../hooks/modal-context.mjs";import"../../components/PrefetchedImage.mjs";import"../../lib/funding/prepareFundingModalData.mjs";import"../../lib/caip2.mjs";import"../../lib/funding/filterSupportedOptions.mjs";import"../../lib/funding/moonpay/index.mjs";import"../../lib/funding/analytics.mjs";import"../../lib/funding/usdc.mjs";import"../../icons/Copy.mjs";jest.mock("ofetch",(()=>{})),jest.mock("../../hooks/privy-context",(()=>({usePrivyContext:jest.fn().mockReturnValue({user:null,connectWallet:jest.fn()}),useLogin:jest.fn().mockReturnValue({login:jest.fn()}),PrivyContext:jest.requireActual("../../hooks/privy-context").PrivyContext}))),jest.mock("../../hooks/useWallets.tsx",(()=>({useWallets:jest.fn().mockReturnValue({wallets:[]})}))),jest.mock("../../lib/ethers",(()=>({getNativeCurrencyFromWei:jest.fn()}))),afterEach((()=>{jest.clearAllMocks()})),describe("UserPill",(()=>{describe("action",(()=>{it("can set login options",(async()=>{let m=i,c=jest.fn();m.mockImplementation((()=>({user:null,login:c,ready:!0})));let{getByText:l}=t(/*#__PURE__*/o(s.Provider,{value:{user:null,login:c,ready:!0},children:[/*#__PURE__*/e(r,{action:{type:"login",options:{loginMethods:["email"]}}}),","]})),a=l("Log in");expect(a).toBeDefined(),n(a,new MouseEvent("click",{bubbles:!0})),expect(c).toHaveBeenCalledWith({loginMethods:["email"]})})),it('can be set to "connectWallet"',(()=>{let n=jest.fn(),{getByText:m}=t(/*#__PURE__*/o(s.Provider,{value:{user:null,login:n,ready:!0},children:[/*#__PURE__*/e(r,{action:{type:"connectWallet"}}),","]}));expect(m("Connect wallet")).toBeDefined(),expect(i).toHaveBeenCalled()})),it("can set connectWallet options",(()=>{let i=jest.fn(),{getByText:m}=t(/*#__PURE__*/o(s.Provider,{value:{user:null,ready:!0,connectWallet:i},children:[/*#__PURE__*/e(r,{action:{type:"connectWallet",options:{suggestedAddress:"0x1234"}},label:"Connect wallet"}),","]})),c=m("Connect wallet");expect(c).toBeDefined(),n(c,new MouseEvent("click",{bubbles:!0})),expect(i).toHaveBeenCalledWith({suggestedAddress:"0x1234"})}))})),it("can have a custom label",(()=>{i.mockImplementation((()=>({user:null,ready:!0})));let{getByText:n}=t(/*#__PURE__*/o(s.Provider,{value:{},children:[/*#__PURE__*/e(r,{label:"Test Label"}),","]}));expect(n("Test Label")).toBeDefined(),expect(i).toHaveBeenCalled()})),it("allows users to log out",(()=>{let o=jest.fn();i.mockImplementation((()=>({user:{name:"John Doe",linkedAccounts:[]},ready:!0,authenticated:!0,logout:o})));let{container:m,getByText:c}=t(/*#__PURE__*/e(s.Provider,{value:{logout:o},children:/*#__PURE__*/e(r,{})})),l=m.querySelector('button[data-state="closed"]');expect(l).toBeDefined(),n(l,new MouseEvent("click",{bubbles:!0})),expect(c("Account")).toBeDefined;let a=c("Log out");expect(a).toBeDefined,expect(o).not.toHaveBeenCalled(),n(a,new MouseEvent("click",{bubbles:!0})),expect(o).toHaveBeenCalled()}))}));
