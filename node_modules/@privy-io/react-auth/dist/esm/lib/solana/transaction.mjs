import{readBigInt64LE as t}from"../../utils/buffer/readBigInt64LE.mjs";const e=1e9,n="11111111111111111111111111111111",r="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA";let o=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2});function a(t,e=6,n=!1,r=!1){let o=(parseFloat(t.toString())/1e9).toFixed(e).replace(/0+$/,"").replace(/\.$/,""),a=r?"":" SOL";return n?`${o}${a}`:`${"0"===o?"<0.001":o}${a}`}function i(t,e){let n=parseFloat(t.toString())/1e9,r=o.format(e*n);return"$0.00"===r?"<$0.01":r}function s({amount:t,fee:e,tokenPrice:n}){let r=BigInt(1e9*parseFloat(t)),o=r+e;return{fundingAmountInBaseUnit:r,fundingAmountInUsd:n?i(r,n):void 0,totalPriceInUsd:n?i(o,n):void 0,totalPriceInNativeCurrency:a(o),feePriceInNativeCurrency:a(e),feePriceInUsd:n?i(e,n):void 0}}function c(t){return"version"in t}function u(t,e,n=0){let r="from"===e?0:"to"===e?1:2;if(c(t)){let e=t.message.getAccountKeys(),o=t.message.compiledInstructions.at(n)?.accountKeyIndexes[r];return o&&e.get(o)||null}let o=t.instructions.at(n)?.keys.at(r)?.pubkey;if(null==o)throw Error(`Transaction does not contain a "${e}" public key`);return o}function l(e,n=!1,r=0){let o=n?1:4;if(c(e)){let n=e.message.compiledInstructions.at(r)?.data;if(!n)return 0n;try{return t(Buffer.from(n),o)}catch(t){return 0n}}let a=e.instructions.at(r)?.data.readBigInt64LE(o);return null==a?0n:a}function f(t,e){if(c(t)){let n=t.message.staticAccountKeys.find((t=>t.toBase58()===e));if(!n)throw Error(`Transaction does not contain public key ${e}`);return n}let n=t.compileMessage().accountKeys.find((t=>t.toBase58()===e));if(!n)throw Error(`Transaction does not contain public key ${e}`);return n}function g(t,e=0){let n;if(c(t)){let r=t.message.compiledInstructions.at(e)?.programIdIndex;if(null==r)throw Error("Transaction does not contain a Program ID");n=t.message.getAccountKeys().get(r)?.toBase58()}else n=t.instructions.at(e)?.programId.toBase58();if(!n)throw Error("Transaction does not contain a Program ID");return"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"===n?"approve":"11111111111111111111111111111111"===n?"transfer":"instruction"}async function m(t,e){return c(t)?(await e.getFeeForMessage(t.message)).value:await t.getEstimatedFee(e)}function d(t,e){return{signature:t,parsedTransaction:e,fees:BigInt(e?.meta?.fee||0)}}async function p(t,e){let n=[],r=c(t)?t.message.compiledInstructions.length:t.instructions.length,o={},a=BigInt(await m(t,e)||0);for(let a=0;a<r;a++){let r=g(t,a),i=u(t,"from",a),s=u(t,"to",a),c=l(t,"approve"===r,a),f="transfer"===r?null:u(t,"owner",a),m=0n;i&&(o[i.toBase58()]||(o[i.toBase58()]=BigInt(await e.getBalance(i))),m=o[i.toBase58()]||0n),n.push({from:i,to:s,spender:f,action:r,amount:c,balance:m,hasFunds:m>=c})}return{fees:a,instructions:n}}export{e as LAMPORTS_PER_SOL,n as SYSTEM_PROGRAM_ID,r as TOKEN_PROGRAM_ID,d as createSolanaTransactionReceipt,p as decodeSolanaTransaction,i as getDollarsFromLamport,a as getNativeCurrencyFromLamports,s as getSolanaFormattedAmounts,g as getTransactionAction,u as getTransactionAddress,m as getTransactionFees,l as getTransactionValue,f as getWalletPublicKeyFromTransaction,c as isVersionedTransaction};
