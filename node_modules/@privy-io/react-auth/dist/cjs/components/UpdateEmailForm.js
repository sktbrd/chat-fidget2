"use strict";var e=require("react/jsx-runtime"),r=require("@heroicons/react/24/outline/EnvelopeIcon"),i=require("react"),s=require("../configuration/context.js"),n=require("../hooks/captcha-context.js"),o=require("../hooks/internal-context.js"),a=require("../hooks/modal-context.js"),t=require("../hooks/privy-context.js"),c=require("../screens/index.js"),u=require("../utils/index.js"),l=require("./Button.js"),d=require("./ui/forms/EmailInputForm.js"),j=require("./ui/typography/ErrorMessage.js");function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("../hooks/index.js"),require("../errors.js"),require("ofetch"),require("@ethersproject/providers"),require("../connectors/get-legacy-injected-providers.js"),require("../connectors/is-wallet-installed.js"),require("./PrefetchedImage.js"),require("styled-components"),require("./Loader.js");var q=/*#__PURE__*/h(r);const m=/*#__PURE__*/i.forwardRef(((r,d)=>{let[h,m]=i.useState(""),[S,f]=i.useState(""),[y,x]=i.useState(!1),{authenticated:E,user:v}=t.usePrivyContext(),{initUpdateEmail:b}=o.usePrivyInternal(),{navigate:C,setModalData:k,currentScreen:A}=a.usePrivyModal(),{enabled:I,token:M}=n.useCaptcha(),P=s.useAppConfig(),R=u.validateEmail(h)&&(P.disablePlusEmails&&h.includes("+")?(S||f("Please enter a valid email address without a '+'."),!1):(S&&f(""),!0)),T=y||!R,D=()=>{!I||M||E?(async e=>{if(!v?.email)throw Error("User is required to have an email address to update it.");x(!0);try{await b(v.email.address,h,e),C(c.ModalScreen.AWAITING_PASSWORDLESS_CODE)}catch(e){k({errorModalData:{error:e,previousScreen:A||c.ModalScreen.LANDING}})}x(!1)})(M):(k({captchaModalData:{callback:e=>{if(!v?.email)throw Error("User is required to have an email address to update it.");return b(v.email.address,h,e)},userIntentRequired:!1,onSuccessNavigateTo:c.ModalScreen.AWAITING_PASSWORDLESS_CODE,onErrorNavigateTo:c.ModalScreen.ERROR_SCREEN}}),C(c.ModalScreen.CAPTCHA_SCREEN))};/*#__PURE__*/return e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsxs(p,{children:[S&&/*#__PURE__*/e.jsx(j.ErrorMessage,{style:{marginTop:"0.25rem",textAlign:"left"},children:S}),/*#__PURE__*/e.jsxs(g,{$error:!!S,children:[/*#__PURE__*/e.jsx(q.default,{}),/*#__PURE__*/e.jsx("input",{ref:d,id:"email-input",type:"email",placeholder:"your@email.com",onChange:e=>m(e.target.value),onKeyUp:e=>{"Enter"===e.key&&D()},value:h,autoComplete:"email"}),r.stacked?null:/*#__PURE__*/e.jsx(l.EmbeddedButton,{isSubmitting:y,onClick:D,disabled:T,children:"Submit"})]})]}),r.stacked?/*#__PURE__*/e.jsx(l.PrimaryButton,{loadingText:null,loading:y,disabled:T,onClick:D,children:"Submit"}):null]})}));let p=d.InputContainerForm,g=d.EmailUpdateForm;exports.UpdateEmailForm=m;
