"use strict";var e=require("react/jsx-runtime"),r=require("react"),o=require("styled-components"),n=require("@privy-io/js-sdk-core"),i=require("../hooks/modal-context.js"),t=require("../recent-login/context.js"),c=require("./Button.js"),a=require("./PhoneCountryDropdown.js"),s=require("./ui/chips/Chip.js");require("./PrefetchedImage.js"),require("../configuration/context.js"),require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("../screens/index.js"),require("../hooks/index.js"),require("../hooks/events-context.js"),require("../storage.js"),require("./Loader.js"),require("./ui/animation/LoadingSkeleton.js");const u=/*#__PURE__*/r.forwardRef(((o,u)=>{let{app:h}=i.usePrivyModal(),[p,g]=r.useState(!1),{accountType:m}=t.useRecentlyUsedLogin(),[j,b]=r.useState(""),[q,x]=r.useState(h?.intl.defaultCountry??"US"),y=n.validatePhoneNumber(j,q),f=n.phoneNumberTypingFormatter(q),v=n.getPlaceholderPhoneNumber(q),w=n.getCountryCallingCode(q),C=!y,[k,P]=r.useState(!1),N=w.length,S=e=>{let r=e.target.value;x(r),b(""),o.onChange&&o.onChange({rawPhoneNumber:j,qualifiedPhoneNumber:n.formatPhoneNumber(j,r),countryCode:r,isValid:n.validatePhoneNumber(j,q)})},z=(e,r)=>{try{let i=e.replace(/\D/g,"")===j.replace(/\D/g,"")?e:f.input(e);b(i),o.onChange&&o.onChange({rawPhoneNumber:i,qualifiedPhoneNumber:n.formatPhoneNumber(e,r),countryCode:r,isValid:n.validatePhoneNumber(e,r)})}catch(e){console.error("Error processing phone number:",e)}},I=()=>{P(!0);let e=n.formatPhoneNumber(j,q);o.onSubmit({rawPhoneNumber:j,qualifiedPhoneNumber:e,countryCode:q,isValid:n.validatePhoneNumber(j,q)}).finally((()=>P(!1)))};return r.useEffect((()=>{if(o.defaultValue){let e=n.getPhoneCountryCodeAndNumber(o.defaultValue);f.reset(),S({target:{value:e.countryCode}}),z(e.phone,e.countryCode)}}),[o.defaultValue]),/*#__PURE__*/e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsx(l,{children:/*#__PURE__*/e.jsxs(d,{$callingCodeLength:N,$stacked:o.stacked,children:[/*#__PURE__*/e.jsx(a.PhoneCountryDropdown,{value:q,onChange:S}),/*#__PURE__*/e.jsx("input",{ref:u,id:"phone-number-input",className:"login-method-button",type:"tel",placeholder:v,onFocus:()=>g(!0),onChange:e=>{z(e.target.value,q)},onKeyUp:e=>{"Enter"===e.key&&I()},value:j,autoComplete:"tel"}),"phone"!==m||p||o.hideRecent?o.stacked||o.noIncludeSubmitButton?/*#__PURE__*/e.jsx("span",{}):/*#__PURE__*/e.jsx(c.EmbeddedButton,{isSubmitting:k,onClick:I,disabled:C,children:"Submit"}):/*#__PURE__*/e.jsx(s.Chip,{color:"gray",children:"Recent"})]})}),o.stacked&&!o.noIncludeSubmitButton?/*#__PURE__*/e.jsx(c.PrimaryButton,{loading:k,loadingText:null,onClick:I,disabled:C,children:"Submit"}):null]})}));let l=/*#__PURE__*/o.styled.div.withConfig({displayName:"InputContainer",componentId:"sc-2a729487-0"})(["width:100%;"]),d=/*#__PURE__*/o.styled.label.withConfig({displayName:"PhoneNumberInput",componentId:"sc-2a729487-1"})(["--country-code-dropdown-width:calc(54px + calc(12 * ","px));--phone-input-extra-padding-left:calc(12px + calc(3 * ","px));display:block;position:relative;width:100%;@media (min-width:441px){--country-code-dropdown-width:calc(52px + calc(10 * ","px));}&& > select{font-size:16px;height:24px;position:absolute;margin:13px calc(var(--country-code-dropdown-width) / 4);line-height:24px;width:var(--country-code-dropdown-width);background-color:var(--privy-color-background);background-size:auto;background-position-x:right;cursor:pointer;@media (min-width:441px){font-size:14px;width:var(--country-code-dropdown-width);}:focus{outline:none;box-shadow:none;}}&& > input{font-size:16px;line-height:24px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:calc(100% - var(--country-code-dropdown-width));padding:12px 88px 12px calc(var(--country-code-dropdown-width) + var(--phone-input-extra-padding-left));padding-right:",";flex-grow:1;background:var(--privy-color-background);border:1px solid var(--privy-color-foreground-4);border-radius:var(--privy-border-radius-mdlg);width:100%;:focus{outline:none;border-color:var(--privy-color-accent);}:autofill,:-webkit-autofill{background:var(--privy-color-background);}@media (min-width:441px){font-size:14px;padding-right:78px;}}&& > :last-child{right:16px;position:absolute;top:50%;transform:translate(0,-50%);}&& > button:last-child{right:0px;line-height:24px;padding:13px 17px;:focus{outline:none;border-color:var(--privy-color-accent);}}&& > input::placeholder{color:var(--privy-color-foreground-3);}"],(e=>e.$callingCodeLength),(e=>e.$callingCodeLength),(e=>e.$callingCodeLength),(e=>e.$stacked?"16px":"88px"));exports.ConnectPhoneNumberForm=u;
