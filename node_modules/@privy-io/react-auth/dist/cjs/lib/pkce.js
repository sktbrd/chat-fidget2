"use strict";var e=require("jose"),r=require("../constants.js"),t=require("../crypto.js"),o=require("../errors.js"),i=require("../storage.js");function n(){return e.base64url.encode(t.randomBytes(36))}require("ofetch"),exports.createCodeVerifier=n,exports.createStateCode=function(){return n()},exports.deriveCodeChallengeFromCodeVerifier=async function(r,o="S256"){if("S256"!=o)return r;{let o=await t.createHashBuffer(r);return e.base64url.encode(o)}},exports.getCodeVerifier=function(){let e=i.default.get(r.CODE_VERIFIER_KEY);if(!e)throw new o.PrivyClientError("Authentication error.");return e};
