"use strict";var e=require("fast-password-entropy"),t=require("secure-password-utilities"),r=require("secure-password-utilities/wordlists");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function a(e){if(e&&"object"==typeof e&&"default"in e)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var n=/*#__PURE__*/s(e),u=/*#__PURE__*/a(t);let i=/[a-z]/,o=/[A-Z]/,l=/[0-9]/,c="!@#$%^&*()\\-_+.",p=`a-zA-Z0-9${c}`,f=RegExp(`[${c}]`),d=RegExp(`[${p}]`);const g=RegExp(`^[${p}]{6,}$`);function x(e){return e>.9?"Strong":e>.5?"Medium":"Weak"}function h(e){if(e.length<8)return 0;let t=0;return i.test(e)&&(t+=1),o.test(e)&&(t+=1),l.test(e)&&(t+=1),f.test(e)&&(t+=1),Math.max(0,Math.min(1,t/3))}function w(e=""){return(.3*h(e)+n.default(e)/95)/2}exports.calculatePasswordDiversityScore=h,exports.generatePassphrase=()=>u.generatePassphrase(4,r.DEFAULT_WORDLIST),exports.getInvalidCharacters=(e="")=>[...new Set(e.split("").filter((e=>!d.test(e))).map((e=>e.replace(" ","SPACE"))))],exports.getPasswordStrength=w,exports.getPasswordStrengthLabel=x,exports.getPasswordSummary=function(e=""){let t=w(e);return{value:t,label:x(t)}},exports.isPassphrase=e=>{let t=e.split("-");return!((t?.length??0)<4)&&t.every((e=>r.DEFAULT_WORDLIST.includes(e)))},exports.validPasswordRegex=g;
