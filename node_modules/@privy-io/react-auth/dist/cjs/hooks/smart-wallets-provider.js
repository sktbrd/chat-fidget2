"use strict";var e=require("react/jsx-runtime"),r=require("react"),i=require("../configuration/context.js"),n=require("../errors.js"),s=require("../lib/getEmbeddedConnectedWallet.js"),t=require("../lib/smart-wallets.js"),c=require("./internal-context.js"),o=require("./privy-context.js"),a=require("./useWallets.js");require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("ofetch"),require("viem"),require("../client/user.js"),require("@ethersproject/address"),require("./modal-context.js"),require("../components/PrefetchedImage.js"),require("../screens/index.js"),require("./index.js"),require("./useSmartWalletChain.js"),require("../utils/index.js"),require("@ethersproject/providers"),require("../connectors/get-legacy-injected-providers.js"),require("../connectors/is-wallet-installed.js"),require("../lib/smart-wallets-shared.js"),require("permissionless"),require("permissionless/accounts"),require("permissionless/clients/pimlico"),require("viem/account-abstraction"),require("@privy-io/js-sdk-core");let l=/*#__PURE__*/r.createContext({client:void 0});let u=/*#__PURE__*/r.createContext({config:void 0}),d=()=>{let{config:e}=r.useContext(u);return{config:e}},j=({children:i})=>{let[n,s]=r.useState(void 0),{client:t}=c.usePrivyInternal();return r.useEffect((()=>{!n&&t&&(async()=>{try{if(!t)return void console.warn("No client found");let e=await t.getSmartWalletsConfig();s(e)}catch(e){console.warn("Error generating smart wallet config: ",e)}})()}),[!!t]),/*#__PURE__*/e.jsx(u.Provider,{value:{config:n},children:i})},h=({config:l,children:u})=>{let{config:j}=d(),{appId:h}=c.usePrivyInternal(),{chains:f,defaultChain:g,rpcConfig:m}=i.useAppConfig(),{wallets:p}=a.useWallets(),{user:v}=o.usePrivyContext(),[y,x]=r.useState(),C=s.getEmbeddedConnectedWallet(p);return r.useEffect((()=>{(async()=>{if(!j?.enabled)return;let e=j.configuredNetworks.find((e=>e.chainId===`eip155:${g.id}`))?g:f.find((e=>j.configuredNetworks.map((e=>e.chainId)).includes(`eip155:${e.id}`)));if(!e)throw new n.PrivyClientError("Could not find smart wallets chain configurations for any Privy client configured chains. Please configure smart wallets for your chains in the Privy dashboard.");x(await t.getSmartWalletClient({chain:e,privyAppId:h,paymasterContext:l?.paymasterContext,rpcConfig:m,embeddedWallet:C,user:v,smartWalletsConfig:j}))})()}),[!!j?.enabled,!!v?.smartWallet,!!C]),/*#__PURE__*/e.jsx(q.Provider,{value:{client:y,config:l},children:u})},q=/*#__PURE__*/r.createContext({client:void 0,config:void 0}),f=({children:i})=>{let{client:n,config:s}=(()=>{let{client:e,config:i}=r.useContext(q);return{client:e,config:i}})(),{config:a}=d(),{wrapSmartAccountClient:u}=t.useSmartWalletsWrapper({clientConfig:s,smartWalletsConfig:a}),{user:j}=o.usePrivyContext(),{generateSiweMessageForSmartWallet:h,linkSmartWallet:f,noPromptOnSignature:g}=c.usePrivyInternal();return r.useEffect((()=>{(async()=>{if(n&&j&&!j?.smartWallet&&a?.enabled)try{let e=await h({address:n.account.address,chainId:`eip155:${n.chain.id}`});g.current=!0;let r=await n.signMessage({message:e});await f({signature:r,message:e,smartWalletType:a.smartWalletType})}catch(e){console.error("Error creating smart wallet:",e)}finally{g.current=!1}})()}),[!!n,!!j?.smartWallet,!!a?.enabled]),/*#__PURE__*/e.jsx(l.Provider,{value:{client:j?.smartWallet&&n?u(n):void 0},children:i})};exports.SmartWalletsProvider=({config:r,children:i})=>/*#__PURE__*/e.jsx(j,{children:/*#__PURE__*/e.jsx(h,{config:r,children:/*#__PURE__*/e.jsx(f,{children:i})})}),exports.useSmartWallets=()=>{let{client:e}=r.useContext(l);return{client:e}};
