"use strict";var e=require("react"),r=require("../errors.js"),t=require("./captcha-context.js"),s=require("./internal-context.js");require("ofetch"),require("react/jsx-runtime"),require("./index.js"),require("../utils/index.js"),require("@ethersproject/providers"),require("../connectors/get-legacy-injected-providers.js"),require("../connectors/is-wallet-installed.js");exports.useLoginWithPasskey=a=>{let i=t.useCaptcha(),{initLoginWithPasskey:o,loginWithPasskey:n,passkeyAuthState:u,setPasskeyAuthState:c}=s.usePrivyInternal();return{loginWithPasskey:e.useCallback((async()=>{try{let e;if(i.enabled&&"error"===i.status)throw new t.CaptchaError(i.error,null,r.PrivyErrorCode.CAPTCHA_FAILURE);i.enabled&&"success"!==i.status&&(i.execute(),e=await i.waitForResult()),await o({captchaToken:e,withPrivyUi:!1});let{user:s,isNewUser:u,wasAlreadyAuthenticated:c,loginAccount:l}=await n();a?.onComplete?.(s,u,c,"passkey",l)}catch(e){throw c({status:"error",error:e}),a?.onError?.(e),e}}),[n,i.status]),state:u}};
