"use strict";var e=require("../constants.js"),r=require("../errors.js"),t=require("./errors.js");require("ofetch"),require("@ethersproject/logger"),require("@privy-io/js-sdk-core");class s{on(e,r){if(this.walletProvider)return this.walletProvider.on(e,r);this._subscriptions.push({eventName:e,listener:r})}async request(e){if(!this.walletProvider)throw new r.PrivyConnectorError(`A wallet request of type ${e.method} was made before setting a wallet provider.`);return Promise.race([this.walletProvider.request(e),this.walletTimeout()]).catch((e=>{throw t.formatConnectorError(e)}))}constructor(r,s){this.removeListener=(e,r)=>{if(this.walletProvider)try{return this.walletProvider.removeListener(e,r)}catch(e){console.warn("Unable to remove wallet provider listener")}},this.walletTimeout=(e=new t.WalletTimeoutError,r=this.rpcTimeoutDuration)=>new Promise(((t,s)=>setTimeout((()=>{s(e)}),r))),this.setWalletProvider=e=>{this.walletProvider&&this._subscriptions.forEach((e=>{this.removeListener(e.eventName,e.listener)})),this.walletProvider=e,this._subscriptions.forEach((e=>{this.walletProvider?.on(e.eventName,e.listener)}))},this.walletProvider=r,this.rpcTimeoutDuration=s||e.DEFAULT_RPC_TIMEOUT,this._subscriptions=[]}}exports.AsAbstractProvider=class extends s{sendAsync(e,r){throw Error("sendAsync is no longer supported by EIP-1193. Use the request method instead.")}constructor(e){super(e,e.rpcTimeoutDuration)}},exports.AsExternalProvider=class extends s{constructor(e){super(e,e.rpcTimeoutDuration)}},exports.PrivyProxyProvider=s;
