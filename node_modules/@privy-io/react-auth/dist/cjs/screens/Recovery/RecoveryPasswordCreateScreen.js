"use strict";var e=require("react/jsx-runtime"),r=require("react"),s=require("../index.js"),o=require("../../effect.js"),n=require("../../errors.js"),t=require("../../hooks/internal-context.js"),i=require("../../hooks/modal-context.js"),a=require("../../hooks/privy-context.js"),c=require("../../hooks/useEmbeddedWalletCreate.js"),l=require("../../password.js"),u=require("../../components/embedded-wallets/SetWalletPasswordForm/SetWalletPasswordForm.js");require("ofetch"),require("../../hooks/index.js"),require("../../components/PrefetchedImage.js"),require("../../configuration/context.js"),require("../../config.js"),require("../../configuration/defaultClientConfig.js"),require("../../constants.js"),require("../../configuration/login-methods.js"),require("../../configuration/wallets.js"),require("../../connectors/chains/index.js"),require("../../connectors/chains/arbitrum.js"),require("../../connectors/chains/arbitrumSepolia.js"),require("../../connectors/chains/avalanche.js"),require("../../connectors/chains/avalancheFuji.js"),require("../../connectors/chains/base.js"),require("../../connectors/chains/baseSepolia.js"),require("../../connectors/chains/berachainArtio.js"),require("../../connectors/chains/celo.js"),require("../../connectors/chains/celoAlfajores.js"),require("../../connectors/chains/filecoin.js"),require("../../connectors/chains/filecoinCalibration.js"),require("../../connectors/chains/garnetHolesky.js"),require("../../connectors/chains/holesky.js"),require("../../connectors/chains/linea.js"),require("../../connectors/chains/lineaTestnet.js"),require("../../connectors/chains/lukso.js"),require("../../connectors/chains/mainnet.js"),require("../../connectors/chains/optimism.js"),require("../../connectors/chains/optimismSepolia.js"),require("../../connectors/chains/polygon.js"),require("../../connectors/chains/polygonAmoy.js"),require("../../connectors/chains/redstone.js"),require("../../connectors/chains/sepolia.js"),require("../../connectors/chains/zora.js"),require("../../connectors/chains/zoraSepolia.js"),require("../../connectors/chains/zoraTestnet.js"),require("../../connectors/chains/utils.js"),require("../../lib/solana/index.js"),require("../../theme.js"),require("tinycolor2"),require("../../lib/cybr53.js"),require("../../client/user.js"),require("@ethersproject/address"),require("fast-password-entropy"),require("secure-password-utilities"),require("secure-password-utilities/wordlists"),require("../../components/embedded-wallets/SetWalletPasswordForm/ConfimWalletPasswordForm.js"),require("@heroicons/react/24/outline/ExclamationTriangleIcon"),require("../../components/Layouts.js"),require("styled-components"),require("../../components/ModalFooter.js"),require("../../svg/protected-by-privy.js"),require("../../components/ModalHeader.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("../../components/embedded-wallets/SetWalletPasswordForm/shared.js"),require("@heroicons/react/24/outline/ArrowPathIcon"),require("@heroicons/react/24/outline/EyeIcon"),require("@heroicons/react/24/outline/EyeSlashIcon"),require("../../components/Button.js"),require("../../components/Loader.js"),require("../../components/embedded-wallets/SetWalletPasswordForm/ConfimWalletPasswordSaved.js"),require("../../components/Checkbox.js"),require("../../components/embedded-wallets/SetWalletPasswordForm/CreateWalletPassword.js"),require("@heroicons/react/24/outline/KeyIcon"),require("@heroicons/react/24/solid/CheckCircleIcon"),require("../../components/embedded-wallets/SetWalletPasswordForm/SaveWalletPassword.js"),require("@heroicons/react/24/outline/ArrowDownTrayIcon"),require("@heroicons/react/24/outline/ClipboardDocumentCheckIcon"),require("@heroicons/react/24/outline/DocumentDuplicateIcon"),require("../../components/embedded-wallets/SetWalletPasswordForm/SetWalletPasswordComplete.js"),require("@heroicons/react/24/solid/XCircleIcon"),require("../../components/ScreenHeader.js"),require("../../components/embedded-wallets/SetWalletPasswordForm/setWalletPassword.hooks.js");exports.EmbeddedWalletPasswordCreateScreen=()=>{let{app:d,navigate:q,data:h,onUserCloseViaDialogOrKeybindRef:j}=i.usePrivyModal(),[m,w]=r.useState(""),[p,S]=r.useState(!1),[y,f]=r.useState(),[P,b]=r.useState(null),{authenticated:C,user:W}=a.usePrivyContext(),{closePrivyModal:g,isNewUserThisSession:E,initializeWalletProxy:v}=t.usePrivyInternal(),{onSuccess:I,onFailure:x,callAuthOnSuccessOnClose:A}=h.createWallet,{createWallet:k}=c.useCreateWallet(),[F,D]=r.useState(null),M=new o.RunEffectOnce((async()=>{try{let e=await k({recoveryPassword:y,user:W});if(!e)return;D(e),E?q(s.ModalScreen.EMBEDDED_WALLET_CREATED_SCREEN):(I(e),g({shouldCallAuthOnSuccess:A}))}catch(e){w(e.message)}}));r.useEffect((()=>{P||v(3e4).then((e=>b(e)))}),[P]),r.useEffect((()=>{if(!C||!W)return q(s.ModalScreen.LANDING),void x(Error("User must be authenticated before creating a Privy wallet"))}),[C]),j.current=()=>null;/*#__PURE__*/return e.jsx(u.SetWalletPasswordForm,{config:{initiatedBy:"automatic"},appName:d?.name||"privy",loading:!P,buttonLoading:p,buttonHideAnimations:!F&&p,isResettingPassword:!1,error:m,password:y||"",onClose:()=>{F&&"user-passcode"!==F?.recoveryMethod?(x(new n.PrivyEmbeddedWalletError("User created a wallet but failed to set a password for it")),g({shouldCallAuthOnSuccess:!1})):F?(I(F),g({shouldCallAuthOnSuccess:A})):(x(new n.PrivyEmbeddedWalletError("User wallet creation failed")),g({shouldCallAuthOnSuccess:!1}))},onPasswordChange:f,onPasswordGenerate:()=>f(l.generatePassphrase()),onSubmit:async()=>(S(!0),M.execute().then((()=>new Promise((e=>setTimeout(e,250))))).finally((()=>S(!1))))})};
