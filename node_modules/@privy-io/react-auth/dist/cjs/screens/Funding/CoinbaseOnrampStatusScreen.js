"use strict";var e=require("react/jsx-runtime"),r=require("@heroicons/react/24/solid/ArrowsRightLeftIcon"),n=require("@heroicons/react/24/solid/CheckCircleIcon"),o=require("react"),i=require("styled-components"),s=require("../../components/Button.js"),t=require("../../components/Layouts.js"),c=require("../../components/Loader.js"),a=require("../../components/ModalFooter.js"),u=require("../../components/ModalHeader.js"),l=require("../../hooks/internal-context.js"),d=require("../../hooks/modal-context.js"),h=require("../../lib/funding/analytics.js"),j=require("../../svg/coinbase-wallet.js"),f=require("../index.js");function m(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../../svg/protected-by-privy.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("../../configuration/context.js"),require("../../config.js"),require("../../configuration/defaultClientConfig.js"),require("../../constants.js"),require("../../configuration/login-methods.js"),require("../../configuration/wallets.js"),require("../../connectors/chains/index.js"),require("../../connectors/chains/arbitrum.js"),require("../../connectors/chains/arbitrumSepolia.js"),require("../../connectors/chains/avalanche.js"),require("../../connectors/chains/avalancheFuji.js"),require("../../connectors/chains/base.js"),require("../../connectors/chains/baseSepolia.js"),require("../../connectors/chains/berachainArtio.js"),require("../../connectors/chains/celo.js"),require("../../connectors/chains/celoAlfajores.js"),require("../../connectors/chains/filecoin.js"),require("../../connectors/chains/filecoinCalibration.js"),require("../../connectors/chains/garnetHolesky.js"),require("../../connectors/chains/holesky.js"),require("../../connectors/chains/linea.js"),require("../../connectors/chains/lineaTestnet.js"),require("../../connectors/chains/lukso.js"),require("../../connectors/chains/mainnet.js"),require("../../connectors/chains/optimism.js"),require("../../connectors/chains/optimismSepolia.js"),require("../../connectors/chains/polygon.js"),require("../../connectors/chains/polygonAmoy.js"),require("../../connectors/chains/redstone.js"),require("../../connectors/chains/sepolia.js"),require("../../connectors/chains/zora.js"),require("../../connectors/chains/zoraSepolia.js"),require("../../connectors/chains/zoraTestnet.js"),require("../../connectors/chains/utils.js"),require("../../lib/solana/index.js"),require("../../theme.js"),require("tinycolor2"),require("../../lib/cybr53.js"),require("../../hooks/index.js"),require("../../components/PrefetchedImage.js");var g=/*#__PURE__*/m(r),p=/*#__PURE__*/m(n);let q=({status:r,onClickCta:n})=>{let{title:i,body:c,cta:a}=o.useMemo((()=>(e=>{switch(e){case"success":return{title:"You've funded your account!",body:"It may take a few minutes for the assets to appear.",cta:"Continue"};case"pending-after-flow":return{title:"In Progress",body:"Almost done. Retrieving transaction status from Coinbase",cta:""};case"error":case"pending-in-flow":return{title:"In Progress",body:"Go back to Coinbase Onramp to finish funding your account.",cta:""}}})(r)),[r]);/*#__PURE__*/return e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsxs(v,{children:[/*#__PURE__*/e.jsx(y,{isSucccess:"success"===r}),/*#__PURE__*/e.jsxs(t.FixedGappedContainer,{children:[/*#__PURE__*/e.jsx("h3",{children:i}),/*#__PURE__*/e.jsx(b,{children:c})]})]}),a&&/*#__PURE__*/e.jsx(s.PrimaryButton,{onClick:n,children:a})]})},y=({isSucccess:r})=>{if(!r){let r="var(--privy-color-foreground-4)";/*#__PURE__*/return e.jsxs("div",{style:{position:"relative"},children:[/*#__PURE__*/e.jsx(c.Loader,{color:r,style:{position:"absolute"}}),/*#__PURE__*/e.jsx(c.LoaderFaint,{color:r}),/*#__PURE__*/e.jsx(j.CoinbaseWallet,{style:{position:"absolute",width:"2.8rem",height:"2.8rem",top:"1.2rem",left:"1.2rem"}})]})}let n=r?p.default:()=>/*#__PURE__*/e.jsx(g.default,{width:"3rem",height:"3rem",style:{backgroundColor:"var(--privy-color-foreground-4)",color:"var(--privy-color-background)",borderRadius:"100%",padding:"0.5rem",margin:"0.5rem"}}),o=r?"var(--privy-color-success)":"var(--privy-color-foreground-4)";/*#__PURE__*/return e.jsx("div",{style:{borderColor:o,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"100%",borderWidth:2,padding:"0.5rem",marginBottom:"0.5rem"},children:n&&/*#__PURE__*/e.jsx(n,{width:"4rem",height:"4rem",color:o})})},b=/*#__PURE__*/i.styled.p.withConfig({displayName:"StatusBody",componentId:"sc-96ef1540-0"})(["font-size:1rem;color:var(--privy-color-foreground-3);margin-bottom:1rem;display:flex;flex-direction:column;gap:1rem;"]),v=/*#__PURE__*/i.styled.div.withConfig({displayName:"ConnectContainer",componentId:"sc-96ef1540-1"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;margin-left:1.75rem;margin-right:1.75rem;padding:2rem 0;"]);exports.CoinbaseOnrampStatusScreen=()=>{let{data:r,setModalData:n,navigate:i,navigateBack:s}=d.usePrivyModal(),{closePrivyModal:t,createAnalyticsEvent:c,client:j}=l.usePrivyInternal(),[m,g]=o.useState("pending-in-flow"),p=o.useRef(0),y={...r?.funding,showAlternateFundingMethod:!0};y.usingDefaultFundingMethod&&(y.usingDefaultFundingMethod=!1);let{partnerUserId:b,popup:v}=r?.coinbaseOnrampStatus??{};return o.useEffect((()=>{if("pending-in-flow"===m||"pending-after-flow"===m){let e=setInterval((async()=>{if(b)try{let{status:e}=await j.getCoinbaseOnRampStatus({partnerUserId:b});if("success"===e)return void g("success");if("failure"===e)throw Error("There was an error completing Coinbase Onramp flow.");if(p.current>=3)return n({funding:y}),void i(f.ModalScreen.FUNDING_METHOD_SELECTION_SCREEN);v?.closed&&(p.current=p.current+1,g("pending-after-flow"))}catch(e){console.error(e),g("error"),c({eventName:h.ON_RAMP_COMPLETE_ANALYTICS_EVENT,payload:{status:"failure",provider:"coinbase-onramp",error:e.message}}),n({funding:{...y,errorMessage:"Something went wrong adding funds. Please try again or use another method."}}),i(f.ModalScreen.FUNDING_METHOD_SELECTION_SCREEN)}}),1500);return()=>clearInterval(e)}}),[b,v,m]),/*#__PURE__*/e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsx(u.ModalHeader,{title:"Fund account",backFn:()=>{n({funding:y}),s()}},"header"),/*#__PURE__*/e.jsx(q,{status:m,onClickCta:t}),/*#__PURE__*/e.jsx(a.BlobbyFooter,{})]})};
