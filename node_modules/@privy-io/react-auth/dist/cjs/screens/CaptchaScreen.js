"use strict";var e=require("react/jsx-runtime"),r=require("./index.js"),n=require("@heroicons/react/24/solid/CheckCircleIcon"),s=require("@heroicons/react/24/solid/XCircleIcon"),i=require("react"),o=require("styled-components"),t=require("../components/Button.js"),c=require("../components/Layouts.js"),a=require("../components/ModalFooter.js"),u=require("../components/ModalHeader.js"),l=require("../components/WrappedLoader.js"),h=require("../hooks/captcha-context.js"),d=require("../hooks/modal-context.js");function j(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../components/Loader.js"),require("../svg/protected-by-privy.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("../configuration/context.js"),require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("../hooks/internal-context.js"),require("../hooks/index.js"),require("../errors.js"),require("ofetch"),require("../utils/index.js"),require("@ethersproject/providers"),require("../connectors/get-legacy-injected-providers.js"),require("../connectors/is-wallet-installed.js"),require("../components/PrefetchedImage.js");var q=/*#__PURE__*/j(n),p=/*#__PURE__*/j(s);let f=/*#__PURE__*/o.styled.div.withConfig({displayName:"CaptchaContainer",componentId:"sc-9afcf974-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;"]);exports.CaptchaScreen=()=>{let{lastScreen:n,currentScreen:s,data:o,navigateBack:j,navigate:m,setModalData:y}=d.usePrivyModal(),{status:g,token:x,waitForResult:C,reset:k,execute:v}=h.useCaptcha(),S=i.useRef([]),b=e=>{S.current=[e,...S.current]},[w,I]=i.useState(!0);i.useEffect((()=>(b(setTimeout(I,1e3,!1)),()=>{S.current.forEach((e=>clearTimeout(e))),S.current=[]})),[]);let[M,R]=i.useState(""),[T,A]=i.useState("Checking that you are a human..."),[P,E]=i.useState(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{},disabled:!0,children:"Continue"})),[N,F]=i.useState(!1),[B,L]=i.useState(3),H=o?.captchaModalData,D=async e=>{try{await(H?.callback(e)),H?.onSuccessNavigateTo&&m(H?.onSuccessNavigateTo,!1)}catch(e){if(e instanceof h.CaptchaError)return;y({errorModalData:{error:e,previousScreen:n||r.ModalScreen.LANDING}}),m(H?.onErrorNavigateTo||r.ModalScreen.ERROR_SCREEN,!1)}};i.useEffect((()=>{"success"===g?b(setTimeout((async()=>{let e=await C();!e||H?.userIntentRequired||D(e)}),1e3)):"ready"===g&&b(setTimeout((()=>{"ready"===g&&v()}),500))}),[g]),i.useEffect((()=>{if(!w)switch(g){case"success":R("Success!"),A("CAPTCHA passed successfully."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{F(!0),D(x)},disabled:!H?.userIntentRequired,loading:N,children:H?.userIntentRequired?"Continue":"Continuing..."}));break;case"loading":R(""),A("Checking that you are a human..."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{},disabled:!0,children:"Continue"}));break;case"error":R("Something went wrong"),B<=0?(A("If you use an adblocker or VPN, try disabling and re-attempting."),E(null)):(A("You did not pass CAPTCHA. Please try again."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:z,children:"Retry"})))}}),[g,w,N]);let z=async()=>{if(B<=0)return;L((e=>e-1)),k(),v();let e=await C();!e||H?.userIntentRequired||D(e)};/*#__PURE__*/return e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsx(u.ModalHeader,{backFn:n&&s!==n?j:void 0}),/*#__PURE__*/e.jsxs(f,{children:["success"===g?/*#__PURE__*/e.jsx(q.default,{fill:"var(--privy-color-success)",width:"64px",height:"64px"}):"error"===g?/*#__PURE__*/e.jsx(p.default,{fill:"var(--privy-color-error)",width:"64px",height:"64px"}):/*#__PURE__*/e.jsx(l.WrappedLoader,{}),/*#__PURE__*/e.jsxs(c.FixedGappedContainer,{children:[M?/*#__PURE__*/e.jsx("h3",{children:M}):null,/*#__PURE__*/e.jsx("p",{children:T})]}),P]}),/*#__PURE__*/e.jsx(a.ModalFooter,{})]})};
