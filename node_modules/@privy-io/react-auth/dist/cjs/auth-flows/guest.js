"use strict";var e=require("jose"),t=require("../constants.js"),r=require("../crypto.js"),s=require("../errors.js"),a=require("../paths.js"),i=require("../storage.js");require("ofetch");exports.GuestFlow=class{getOrCreateGuestCredential(s){let a=t.getGuestCredentialStorageKey(s);if(i.isLocalStorageAccessible()){if(i.default.get(a))return i.default.get(a);{let t=e.base64url.encode(r.randomBytes(32));return i.default.put(a,t),t}}return e.base64url.encode(r.randomBytes(32))}async authenticate(){if(!this.api)throw new s.PrivyClientError("Auth flow has no API instance");try{return await this.api.post(a.guestAccountAuthenticatePath,{guest_credential:this.meta.guestCredential})}catch(e){throw s.formatApiError(e)}}async link(){throw Error("Linking is not supported for the guest flow")}constructor(e){this.meta={guestCredential:this.getOrCreateGuestCredential(e)}}};
